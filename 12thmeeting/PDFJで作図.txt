PDFJで作図～石畳と蛇腹

2010/5/1
Kansai.pm 12回ミーティング
nakajima@netstock.co.jp


○はじめに

PDF生成モジュールPDFJの応用例として、文書作成でなく作図に利用した例を二つ紹介

Perlで座標計算して作図しPDFで出力したい
なぜPerl? 
  → 使い慣れてるから(^^)
なぜPDF? 
  → 単なる画像ファイルでは正しいスケールでの印刷が期待できない
  → PDFの作図命令で作図すればDXFなどに変換してドロー系ソフトに持って行ける


○敷石・積石パターン生成①

http://www.stillberg.com/Pave/Pave.html

鉄道模型や建築模型などで使う、敷石（石畳）や積石（レンガ壁）のパターンを生成
いろいろな石の並べ方・積み方や、縮尺などを指定
石や目地の色や影も付けて、印刷して使用
白黒のパターンとして生成し、UV硬化樹脂で型を作るのに使用
石の枠線のみ描画し、DXFに変換してプロッタで使用

○敷石・積石パターン生成②

プログラムのポイント

PDFJのShape（図形オブジェクト）のbox,circle,polygonを使用
目地の色はまずページ全体にboxで塗り、ランダムな汚しはcircleで
石の角の座標を計算しpolygonで描画

単純にページ全体に全ての石を描画すると、サイズが大きくなり、表示も非常に遅くなる
  → minipage内にひとまとまりのパターンを生成し、それを繰り返しページに配置することで、軽量化と高速化を図っている
  → PDFJのminipageは、矩形の領域にページのようにテキスト・画像・図形を配置でき、それ自体をページの任意の位置に繰り返し配置できる（PDFの「フォームXobject」として実装）


○カメラ蛇腹作成

http://www.stillberg.com/bellows/bellows.html

クラシックカメラや大・中判カメラで使用される蛇腹（ベローズ）を自作するために作図する
手で作図するのでは狂いが生じやすいため
DXFに変換してプロッタで使用
